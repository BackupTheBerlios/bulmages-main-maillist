<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [BulmaGés][Gitorious] Activity: tborras pushed 1 commits to master...
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/bulmages-main/2013-February/index.html" >
   <LINK REL="made" HREF="mailto:bulmages-main%40lists.berlios.de?Subject=Re%3A%20%3D%3Futf-8%3Fb%3FW0J1bG1hR8Opc10%3D%3F%3D%0A%09%3D%3Fiso-8859-1%3Fq%3F%3D5BGitorious%3D5D_Activ%3F%3D%0A%09%3D%3Fiso-8859-1%3Fq%3Fity%3D3A_tborras_pushed_1_commits_to_master%3D2E%3D2E%3D2E%3F%3D&In-Reply-To=%3CCAL3Ob3FOZZQBMbtYJQUDhhirxQkip1skK7RedSzbQPb00%3DJN3g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <LINK REL="Previous"  HREF="007522.html">
   <LINK REL="Next"  HREF="007524.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[BulmaGés][Gitorious] Activity: tborras pushed 1 commits to master... </H1>
    <B>René</B> 
    <A HREF="mailto:bulmages-main%40lists.berlios.de?Subject=Re%3A%20%3D%3Futf-8%3Fb%3FW0J1bG1hR8Opc10%3D%3F%3D%0A%09%3D%3Fiso-8859-1%3Fq%3F%3D5BGitorious%3D5D_Activ%3F%3D%0A%09%3D%3Fiso-8859-1%3Fq%3Fity%3D3A_tborras_pushed_1_commits_to_master%3D2E%3D2E%3D2E%3F%3D&In-Reply-To=%3CCAL3Ob3FOZZQBMbtYJQUDhhirxQkip1skK7RedSzbQPb00%3DJN3g%40mail.gmail.com%3E"
       TITLE="[BulmaGés][Gitorious] Activity: tborras pushed 1 commits to master...">ochominutosdearco en gmail.com
       </A><BR>
    <I>Vie Feb  8 05:58:27 CET 2013</I>
    <P><UL>
        <LI>Mensaje anterior: <A HREF="007522.html">[BulmaGés] [Gitorious] Activity: tborras pushed 1	commits to master...
</A></li>
        <LI>Próximo mensaje: <A HREF="007524.html">[BulmaGés][Gitorious] Activity: tborras pushed 1 commits to master...
</A></li>
         <LI> <B>Mensajes ordenados por:</B> 
              <a href="date.html#7523">[ fecha ]</a>
              <a href="thread.html#7523">[ hilo ]</a>
              <a href="subject.html#7523">[ asunto ]</a>
              <a href="author.html#7523">[ autor ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Buenas noches mon ami. :)
 El 08/02/2013 05:55, &quot;Gitorious&quot; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/bulmages-main">no-reply at gitorious.org</A>&gt; escribió:

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hello bulmagesmailing,
</I>&gt;<i>
</I>&gt;<i> One of your favorites has a new activity:
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> tborras pushed 1 commits to master
</I>&gt;<i> master changed from 3ff7a80 to 2d2d908
</I>&gt;<i>
</I>&gt;<i> View the commit log at <A HREF="https://gitorious.org/bulmages/bulmages/commits">https://gitorious.org/bulmages/bulmages/commits</A>
</I>&gt;<i>
</I>&gt;<i> View the diff online:
</I>&gt;<i> <A HREF="https://gitorious.org/bulmages/bulmages/commit/3ff7a8000f49cbcb65899528520d02d450a8e62b/diffs/2d2d90848ecdf6fe10d4d813f08b28474ac120f2">https://gitorious.org/bulmages/bulmages/commit/3ff7a8000f49cbcb65899528520d02d450a8e62b/diffs/2d2d90848ecdf6fe10d4d813f08b28474ac120f2</A>
</I>&gt;<i>
</I>&gt;<i> Diff:
</I>&gt;<i>
</I>&gt;<i> commit 2d2d90848ecdf6fe10d4d813f08b28474ac120f2
</I>&gt;<i> Author: Tomeu Borras &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/bulmages-main">tborras at conetxia.com</A>&gt;
</I>&gt;<i> Date:   Fri Feb 8 05:36:35 2013 +0100
</I>&gt;<i>
</I>&gt;<i>     Con este commit se pueden agregar pestañas a una ficha existente
</I>&gt;<i> mediante los archivos de especificaciones.
</I>&gt;<i>
</I>&gt;<i>     Para ello he ampliado el XML reconocido en los archivos .spc que ahora
</I>&gt;<i> soportan el tag &lt;TAB&gt;&lt;/TAB&gt;
</I>&gt;<i>
</I>&gt;<i>     y llevan como parametros adicionales
</I>&gt;<i>
</I>&gt;<i>     &lt;NAME&gt;&lt;/NAME&gt;
</I>&gt;<i>     &lt;UI_INTERFACE&gt;&lt;/UI_INTERFACE&gt;
</I>&gt;<i>
</I>&gt;<i>     Y como es natural los famosos &lt;CAMPO&gt;&lt;/CAMPO&gt; y ahora también
</I>&gt;<i> &lt;SUBFORM&gt;&lt;/SUBFORM&gt;
</I>&gt;<i>
</I>&gt;<i>     De esta forma las fichas existentens son extensibles al mismo nivel
</I>&gt;<i> que los autoformularios.
</I>&gt;<i>
</I>&gt;<i>     Pongo un ejemplo de uso en el &quot;supuesto&quot; archivo
</I>&gt;<i> ArticuloBase_XXX_spec.spc que altera la ficha de articulos:
</I>&gt;<i>
</I>&gt;<i>     &lt;DOCUMENT&gt;
</I>&gt;<i>     &lt;TAB&gt;
</I>&gt;<i>     &lt;NAME&gt;Ultimas Compras&lt;/NAME&gt;
</I>&gt;<i>     &lt;UI_INTERFACE&gt;/tmp/sociobase.ui&lt;/UI_INTERFACE&gt;
</I>&gt;<i>
</I>&gt;<i>     &lt;SUBFORM&gt;
</I>&gt;<i>     &lt;NOMCAMPO&gt;listart&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;Reservas&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;FILECONFIG&gt;reservassocio&lt;/FILECONFIG&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOTHING&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;QUERY&gt;SELECT * FROM lalbaranp NATURAL LEFT JOIN albaranp NATURAL
</I>&gt;<i> LEFT JOIN proveedor WHERE idarticulo = [idarticulo] &lt;/QUERY&gt;
</I>&gt;<i>       &lt;VINCULOS&gt;idarticulo = idarticulo&lt;/VINCULOS&gt;
</I>&gt;<i>       &lt;TABLENAME&gt;articulo&lt;/TABLENAME&gt;
</I>&gt;<i>       &lt;FIELDID&gt;idarticulo&lt;/FIELDID&gt;
</I>&gt;<i>       &lt;ALLOWNULL&gt;FALSE&lt;/ALLOWNULL&gt;
</I>&gt;<i>       &lt;ALLOWINSERT&gt;FALSE&lt;/ALLOWINSERT&gt;
</I>&gt;<i>       &lt;ALLOWDELETE&gt;FALSE&lt;/ALLOWDELETE&gt;
</I>&gt;<i>       &lt;SETSORTING&gt;FALSE&lt;/SETSORTING&gt;
</I>&gt;<i>
</I>&gt;<i>       &lt;HEADER&gt;
</I>&gt;<i>       &lt;NOMCAMPO&gt;nomproveedor&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;Proveedor&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;DBTYPECAMPO&gt;DBVARCHAR&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOSAVE&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOSAVE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOWRITE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;/HEADER&gt;
</I>&gt;<i>       &lt;HEADER&gt;
</I>&gt;<i>       &lt;NOMCAMPO&gt;fechaalbaranp&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;Fecha&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;DBTYPECAMPO&gt;DBDATE&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOSAVE&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOSAVE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOWRITE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;/HEADER&gt;
</I>&gt;<i>       &lt;HEADER&gt;
</I>&gt;<i>       &lt;NOMCAMPO&gt;cifproveedor&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;CIF Proveedor&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;DBTYPECAMPO&gt;DBINT&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOSAVE&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOSAVE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOWRITE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;/HEADER&gt;
</I>&gt;<i>       &lt;HEADER&gt;
</I>&gt;<i>       &lt;NOMCAMPO&gt;cantlalbaranp&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;Cantidad&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;DBTYPECAMPO&gt;DBINT&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOSAVE&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOSAVE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOWRITE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;/HEADER&gt;
</I>&gt;<i>       &lt;HEADER&gt;
</I>&gt;<i>       &lt;NOMCAMPO&gt;pvplalbaranp&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;Precio&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;DBTYPECAMPO&gt;DBVARCHAR&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOSAVE&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOSAVE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOWRITE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;/HEADER&gt;
</I>&gt;<i>     &lt;/SUBFORM&gt;
</I>&gt;<i>
</I>&gt;<i>     &lt;/TAB&gt;
</I>&gt;<i>
</I>&gt;<i>     &lt;TAB&gt;
</I>&gt;<i>      &lt;NAME&gt;Ultimas Ventas&lt;/NAME&gt;
</I>&gt;<i>      &lt;UI_INTERFACE&gt;/tmp/sociobase1.ui&lt;/UI_INTERFACE&gt;
</I>&gt;<i>
</I>&gt;<i>     &lt;SUBFORM&gt;
</I>&gt;<i>      &lt;NOMCAMPO&gt;listart1&lt;/NOMCAMPO&gt;
</I>&gt;<i>      &lt;NOMPCAMPO&gt;Reservas&lt;/NOMPCAMPO&gt;
</I>&gt;<i>      &lt;FILECONFIG&gt;reservassocio&lt;/FILECONFIG&gt;
</I>&gt;<i>      &lt;RESTRICTIONSCAMPO&gt;DBNOTHING&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>      &lt;QUERY&gt;SELECT * FROM lalbaran NATURAL LEFT JOIN albaran NATURAL LEFT
</I>&gt;<i> JOIN cliente WHERE idarticulo = [idarticulo] &lt;/QUERY&gt;
</I>&gt;<i>      &lt;VINCULOS&gt;idarticulo = idarticulo&lt;/VINCULOS&gt;
</I>&gt;<i>      &lt;TABLENAME&gt;articulo&lt;/TABLENAME&gt;
</I>&gt;<i>      &lt;FIELDID&gt;idarticulo&lt;/FIELDID&gt;
</I>&gt;<i>      &lt;ALLOWNULL&gt;FALSE&lt;/ALLOWNULL&gt;
</I>&gt;<i>      &lt;ALLOWINSERT&gt;FALSE&lt;/ALLOWINSERT&gt;
</I>&gt;<i>      &lt;ALLOWDELETE&gt;FALSE&lt;/ALLOWDELETE&gt;
</I>&gt;<i>      &lt;SETSORTING&gt;FALSE&lt;/SETSORTING&gt;
</I>&gt;<i>
</I>&gt;<i>     &lt;HEADER&gt;
</I>&gt;<i>       &lt;NOMCAMPO&gt;nomcliente&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;Cliente&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;DBTYPECAMPO&gt;DBINT&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOSAVE&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOSAVE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOWRITE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>     &lt;/HEADER&gt;
</I>&gt;<i>     &lt;HEADER&gt;
</I>&gt;<i>       &lt;NOMCAMPO&gt;fechaalbaran&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;Fecha&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;DBTYPECAMPO&gt;DBINT&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOSAVE&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOSAVE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOWRITE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>     &lt;/HEADER&gt;
</I>&gt;<i>     &lt;HEADER&gt;
</I>&gt;<i>       &lt;NOMCAMPO&gt;cifcliente&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;CIF Cliente&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;DBTYPECAMPO&gt;DBINT&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOSAVE&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOSAVE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOWRITE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>     &lt;/HEADER&gt;
</I>&gt;<i>     &lt;HEADER&gt;
</I>&gt;<i>       &lt;NOMCAMPO&gt;cantlalbaran&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;Cantidad&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;DBTYPECAMPO&gt;DBINT&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOSAVE&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOSAVE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOWRITE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>     &lt;/HEADER&gt;
</I>&gt;<i>     &lt;HEADER&gt;
</I>&gt;<i>       &lt;NOMCAMPO&gt;pvplalbaran&lt;/NOMCAMPO&gt;
</I>&gt;<i>       &lt;NOMPCAMPO&gt;Precio Venta&lt;/NOMPCAMPO&gt;
</I>&gt;<i>       &lt;DBTYPECAMPO&gt;DBVARCHAR&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>       &lt;RESTRICTIONSCAMPO&gt;DBNOSAVE&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOSAVE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>       &lt;OPTIONSHEADER&gt;DBNOWRITE&lt;/OPTIONSHEADER&gt;
</I>&gt;<i>     &lt;/HEADER&gt;
</I>&gt;<i>     &lt;/SUBFORM&gt;
</I>&gt;<i>
</I>&gt;<i>     &lt;/TAB&gt;
</I>&gt;<i>
</I>&gt;<i>     &lt;FICHA&gt;
</I>&gt;<i>         &lt;CAMPO&gt;
</I>&gt;<i>                 &lt;NOMCAMPO&gt;fechancliente&lt;/NOMCAMPO&gt;
</I>&gt;<i>                 &lt;NOMPCAMPO&gt;Tel. Movil&lt;/NOMPCAMPO&gt;
</I>&gt;<i>                 &lt;DBTYPECAMPO&gt;DBDATE&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>                 &lt;RESTRICTIONSCAMPO&gt;DBNOTHING&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>         &lt;/CAMPO&gt;
</I>&gt;<i>         &lt;CAMPO&gt;
</I>&gt;<i>                 &lt;NOMCAMPO&gt;fechanincliente&lt;/NOMCAMPO&gt;
</I>&gt;<i>                 &lt;NOMPCAMPO&gt;Tel. Jodes&lt;/NOMPCAMPO&gt;
</I>&gt;<i>             &lt;DBTYPECAMPO&gt;DBDATE&lt;/DBTYPECAMPO&gt;
</I>&gt;<i>                 &lt;RESTRICTIONSCAMPO&gt;DBNOTHING&lt;/RESTRICTIONSCAMPO&gt;
</I>&gt;<i>         &lt;/CAMPO&gt;
</I>&gt;<i>     &lt;/FICHA&gt;
</I>&gt;<i>
</I>&gt;<i>     &lt;/DOCUMENT&gt;
</I>&gt;<i>
</I>&gt;<i>     NOTA: Si la ficha a la que intentamos adjuntar un TAB no tiene ningún
</I>&gt;<i> QTabWidget entonces no funcionara.
</I>&gt;<i>     NOTA2: Notad la diferencia entre &lt;TAB&gt; y &lt;FICHA&gt;. El primero crea los
</I>&gt;<i> campos y en el segundo se diseñan mediante el archivo de QtDesigner
</I>&gt;<i> indicado en &lt;UI_INTERFACE&gt;
</I>&gt;<i>
</I>&gt;<i> diff --git a/bulmages/bulmalib/src/blform.cpp
</I>&gt;<i> b/bulmages/bulmalib/src/blform.cpp
</I>&gt;<i> index cfff188..19195d7 100644
</I>&gt;<i> --- a/bulmages/bulmalib/src/blform.cpp
</I>&gt;<i> +++ b/bulmages/bulmalib/src/blform.cpp
</I>&gt;<i> @@ -63,11 +63,8 @@ BlForm::BlForm ( QWidget *parent, Qt::WFlags f, edmode
</I>&gt;<i> modo ) : BlWidget ( paren
</I>&gt;<i>      setContextMenuPolicy ( Qt::CustomContextMenu );
</I>&gt;<i>      connect ( this, SIGNAL ( customContextMenuRequested ( const QPoint &amp;
</I>&gt;<i> ) ), this, SLOT ( on_customContextMenuRequested ( const QPoint &amp; ) ) );
</I>&gt;<i>      m_modo = modo;
</I>&gt;<i> +    m_firstLoad = TRUE;
</I>&gt;<i>      dialogChanges_readValues();
</I>&gt;<i> -
</I>&gt;<i> -
</I>&gt;<i> -
</I>&gt;<i> -
</I>&gt;<i>  }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> @@ -142,6 +139,7 @@ BlForm::BlForm ( BlMainCompany *emp, QWidget *parent,
</I>&gt;<i> Qt::WFlags f, edmode modo
</I>&gt;<i>      setContextMenuPolicy ( Qt::CustomContextMenu );
</I>&gt;<i>      connect ( this, SIGNAL ( customContextMenuRequested ( const QPoint &amp;
</I>&gt;<i> ) ), this, SLOT ( on_customContextMenuRequested ( const QPoint &amp; ) ) );
</I>&gt;<i>      m_modo = modo;
</I>&gt;<i> +    m_firstLoad = TRUE;
</I>&gt;<i>      dialogChanges_readValues();
</I>&gt;<i>
</I>&gt;<i>  }
</I>&gt;<i> @@ -168,6 +166,12 @@ void BlForm::loadSpecs()
</I>&gt;<i>  {
</I>&gt;<i>      BL_FUNC_DEBUG
</I>&gt;<i>
</I>&gt;<i> +    if (m_firstLoad) {
</I>&gt;<i> +       m_firstLoad = FALSE;
</I>&gt;<i> +    } else {
</I>&gt;<i> +      return;
</I>&gt;<i> +    }// end if
</I>&gt;<i> +
</I>&gt;<i>          /// Disparamos los plugins
</I>&gt;<i>      int res1 = g_plugins-&gt;run ( &quot;BlForm_loadSpecs&quot;, this );
</I>&gt;<i>      if ( res1 != 0 ) {
</I>&gt;<i> @@ -189,6 +193,223 @@ void BlForm::loadSpecs()
</I>&gt;<i>      file.close();
</I>&gt;<i>
</I>&gt;<i>      QDomElement docElem = doc.documentElement();
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +    QDomNodeList tabnodos = docElem.elementsByTagName ( &quot;TAB&quot; );
</I>&gt;<i> +    for ( int i = 0; i &lt; tabnodos.count(); i++ ) {
</I>&gt;<i> +        QDomNode ventana = tabnodos.item ( i );
</I>&gt;<i> +        QDomElement e1 = ventana.toElement(); /// try to convert the node
</I>&gt;<i> to an element.
</I>&gt;<i> +        if ( !e1.isNull() ) { /// the node was really an element.
</I>&gt;<i> +          QString name = e1.firstChildElement ( &quot;NAME&quot;
</I>&gt;<i> ).toElement().text();
</I>&gt;<i> +           QString interfacefile = e1.firstChildElement ( &quot;UI_INTERFACE&quot;
</I>&gt;<i> ).toElement().text();
</I>&gt;<i> +            QTabWidget *tab =  findChild&lt;QTabWidget *&gt;();
</I>&gt;<i> +           if (tab) {
</I>&gt;<i> +             BlUiLoader loader(mainCompany());
</I>&gt;<i> +             QFile file(interfacefile);
</I>&gt;<i> +             file.open(QFile::ReadOnly);
</I>&gt;<i> +             QWidget *myWidget = loader.load(&amp;file, this);
</I>&gt;<i> +             tab-&gt;insertTab(-1,myWidget,name);
</I>&gt;<i> +           } else {
</I>&gt;<i> +             blMsgInfo(&quot;Se ha encontrado una especificacion TAB para una
</I>&gt;<i> ficha que no posee QTabWidget&quot;);
</I>&gt;<i> +           } // end if
</I>&gt;<i> +               QDomNodeList nodos = e1.elementsByTagName ( &quot;CAMPO&quot; );
</I>&gt;<i> +               for ( int j = 0; j &lt; nodos.count(); j++ ) {
</I>&gt;<i> +                   QDomNode ventana = nodos.item ( j );
</I>&gt;<i> +                   QDomElement e1 = ventana.toElement(); /// try to
</I>&gt;<i> convert the node to an element.
</I>&gt;<i> +                   if ( !e1.isNull() ) { /// the node was really an
</I>&gt;<i> element.
</I>&gt;<i> +                       BlDbField::DbType type = BlDbField::DbVarChar;
</I>&gt;<i> +                       QString nomheader = e1.firstChildElement (
</I>&gt;<i> &quot;NOMCAMPO&quot; ).toElement().text();
</I>&gt;<i> +                       if ( exists ( nomheader ) ) return ;
</I>&gt;<i> +                       QString nompheader = e1.firstChildElement (
</I>&gt;<i> &quot;NOMPCAMPO&quot; ).toElement().text();
</I>&gt;<i> +                       QString typeheader = e1.firstChildElement (
</I>&gt;<i> &quot;DBTYPECAMPO&quot; ).toElement().text();
</I>&gt;<i> +                       if ( typeheader == &quot;DBVARCHAR&quot; ) {
</I>&gt;<i> +                           type = BlDbField::DbVarChar;
</I>&gt;<i> +                       } else if ( typeheader == &quot;DBINT&quot; ) {
</I>&gt;<i> +                           type = BlDbField::DbInt;
</I>&gt;<i> +                       } else if ( typeheader == &quot;DBNUMERIC&quot; ) {
</I>&gt;<i> +                           type = BlDbField::DbNumeric;
</I>&gt;<i> +                       } else if ( typeheader == &quot;DBBOOLEAN&quot; ) {
</I>&gt;<i> +                           type = BlDbField::DbBoolean;
</I>&gt;<i> +                       } else if ( typeheader == &quot;DBDATE&quot; ) {
</I>&gt;<i> +                           type = BlDbField::DbDate;
</I>&gt;<i> +                       } // end if
</I>&gt;<i> +
</I>&gt;<i> +                       int restricciones = ( int ) BlDbField::DbNothing;
</I>&gt;<i> +                       QDomElement restrict = e1.firstChildElement (
</I>&gt;<i> &quot;RESTRICTIONSCAMPO&quot; );
</I>&gt;<i> +                       while ( !restrict.isNull() ) {
</I>&gt;<i> +                           QString trestrict = restrict.text();
</I>&gt;<i> +                           if ( trestrict == &quot;DBNOTHING&quot; ) {
</I>&gt;<i> +                               restricciones |= BlDbField::DbNothing;
</I>&gt;<i> +                           } else if ( trestrict == &quot;DBNOTNULL&quot; ) {
</I>&gt;<i> +                               restricciones |= BlDbField::DbNotNull;
</I>&gt;<i> +                           } else if ( trestrict == &quot;DBPRIMARYKEY&quot; ) {
</I>&gt;<i> +                               restricciones |= BlDbField::DbPrimaryKey;
</I>&gt;<i> +                           } else if ( trestrict == &quot;DBNOSAVE&quot; ) {
</I>&gt;<i> +                               restricciones |= BlDbField::DbNoSave;
</I>&gt;<i> +                           } else if ( trestrict == &quot;DBAUTO&quot; ) {
</I>&gt;<i> +                               restricciones |= BlDbField::DbAuto;
</I>&gt;<i> +                           } else if ( trestrict == &quot;DBAUTO&quot; ) {
</I>&gt;<i> +                               restricciones |= BlDbField::DbAuto;
</I>&gt;<i> +                           } else if ( trestrict == &quot;DBDUPPRIMARYKEY&quot; ) {
</I>&gt;<i> +                               restricciones |=
</I>&gt;<i> BlDbField::DbDupPrimaryKey;
</I>&gt;<i> +                           } else if ( trestrict == &quot;DBREQUIRED&quot; ) {
</I>&gt;<i> +                               restricciones |= BlDbField::DbRequired;
</I>&gt;<i> +                           } else if ( trestrict == &quot;DBNOLOAD&quot; ) {
</I>&gt;<i> +                               restricciones |= BlDbField::DbNoLoad;
</I>&gt;<i> +                           } // end if
</I>&gt;<i> +                           restrict = restrict.nextSiblingElement (
</I>&gt;<i> &quot;RESTRICTIONSCAMPO&quot; );
</I>&gt;<i> +                       } // end while
</I>&gt;<i> +
</I>&gt;<i> +                       addDbField ( nomheader, type, (
</I>&gt;<i> BlDbField::DbRestrict ) restricciones, nompheader );
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +                       QString tipocampo = e1.firstChildElement (
</I>&gt;<i> &quot;TIPOCAMPO&quot; ).toElement().text();
</I>&gt;<i> +                       if (tipocampo == &quot;BLCOMBOBOX&quot;) {
</I>&gt;<i> +                           QString nombre= &quot;mui_&quot;+nomheader;
</I>&gt;<i> +                           BlComboBox * combo = findChild&lt;BlComboBox
</I>&gt;<i> *&gt;(nombre);
</I>&gt;<i> +                           QString query = e1.firstChildElement ( &quot;QUERY&quot;
</I>&gt;<i> ).toElement().text();
</I>&gt;<i> +                           QString tablename = e1.firstChildElement (
</I>&gt;<i> &quot;TABLENAME&quot; ).toElement().text();
</I>&gt;<i> +                           QString fieldid = e1.firstChildElement (
</I>&gt;<i> &quot;FIELDID&quot; ).toElement().text();
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +                           // Para no liarla parda, ponemos provincias y
</I>&gt;<i> asi no habrá pedatas de momento.
</I>&gt;<i> +                           combo-&gt;setQuery ( query );
</I>&gt;<i> +                           combo-&gt;setTableName ( tablename );
</I>&gt;<i> +                           combo-&gt;setFieldId ( fieldid );
</I>&gt;<i> +                           QDomNodeList nodos = e1.elementsByTagName (
</I>&gt;<i> &quot;VALOR&quot; );
</I>&gt;<i> +                           for ( int j = 0; j &lt; nodos.count(); j++ ) {
</I>&gt;<i> +                               QDomNode ventana = nodos.item ( j );
</I>&gt;<i> +                               QString va = ventana.toElement().text();
</I>&gt;<i> /// try to convert the node to an element.
</I>&gt;<i> +                               combo-&gt;m_valores[va] = &quot;&quot;;
</I>&gt;<i> +                           } // end for
</I>&gt;<i> +                           combo-&gt;setAllowNull ( TRUE );
</I>&gt;<i> +                           combo-&gt;setId ( &quot;&quot; );
</I>&gt;<i> +                       } // end if
</I>&gt;<i> +
</I>&gt;<i> +                       if (tipocampo == &quot;BLSEARCHWIDGET&quot;) {
</I>&gt;<i> +                           QString nombre= &quot;mui_&quot;+nomheader;
</I>&gt;<i> +                           BlSearchWidget * search =
</I>&gt;<i> findChild&lt;BlSearchWidget *&gt;(nombre);
</I>&gt;<i> +                           QString label = e1.firstChildElement ( &quot;LABEL&quot;
</I>&gt;<i> ).toElement().text();
</I>&gt;<i> +                           QString tablename = e1.firstChildElement (
</I>&gt;<i> &quot;TABLENAME&quot; ).toElement().text();
</I>&gt;<i> +                           QString fieldid = e1.firstChildElement (
</I>&gt;<i> &quot;FIELDID&quot; ).toElement().text();
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +                           // Para no liarla parda, ponemos provincias y
</I>&gt;<i> asi no habrá pedatas de momento.
</I>&gt;<i> +                           search-&gt;setLabel ( label );
</I>&gt;<i> +                           search-&gt;setTableName ( tablename );
</I>&gt;<i> +                           search-&gt;setFieldId ( fieldid );
</I>&gt;<i> +                           QDomNodeList nodos = e1.elementsByTagName (
</I>&gt;<i> &quot;VALOR&quot; );
</I>&gt;<i> +                           for ( int j = 0; j &lt; nodos.count(); j++ ) {
</I>&gt;<i> +                               QDomNode ventana = nodos.item ( j );
</I>&gt;<i> +                               QString va = ventana.toElement().text();
</I>&gt;<i> /// try to convert the node to an element.
</I>&gt;<i> +                               search-&gt;m_valores[va] = &quot;&quot;;
</I>&gt;<i> +                           } // end for
</I>&gt;<i> +                           search-&gt;setId ( &quot;&quot; );
</I>&gt;<i> +                       } // end if
</I>&gt;<i> +
</I>&gt;<i> +                   } // end if
</I>&gt;<i> +               } // end for
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +               /// Cargamos los subformularios
</I>&gt;<i> +               QDomNodeList nodoss = e1.elementsByTagName ( &quot;SUBFORM&quot; );
</I>&gt;<i> +               for ( int j = 0; j &lt; nodoss.count(); j++ ) {
</I>&gt;<i> +                   QDomNode ventana = nodoss.item ( j );
</I>&gt;<i> +                   QDomElement e1 = ventana.toElement(); /// try to
</I>&gt;<i> convert the node to an element.
</I>&gt;<i> +                   if ( !e1.isNull() ) { /// the node was really an
</I>&gt;<i> element.
</I>&gt;<i> +                       BlDbField::DbType type = BlDbField::DbVarChar;
</I>&gt;<i> +                       QString nomheader = e1.firstChildElement (
</I>&gt;<i> &quot;NOMCAMPO&quot; ).toElement().text();
</I>&gt;<i> +                       if ( exists ( nomheader ) ) return;
</I>&gt;<i> +                       QString nompheader = e1.firstChildElement (
</I>&gt;<i> &quot;NOMPCAMPO&quot; ).toElement().text();
</I>&gt;<i> +                       BlSubForm * subform = findChild&lt;BlSubForm
</I>&gt;<i> *&gt;(&quot;mui_&quot; + nomheader);
</I>&gt;<i> +                       QString tablename = e1.firstChildElement (
</I>&gt;<i> &quot;TABLENAME&quot; ).toElement().text();
</I>&gt;<i> +                       QString fieldid = e1.firstChildElement ( &quot;FIELDID&quot;
</I>&gt;<i> ).toElement().text();
</I>&gt;<i> +                       QString fileconfig = e1.firstChildElement (
</I>&gt;<i> &quot;FILECONFIG&quot; ).toElement().text();
</I>&gt;<i> +
</I>&gt;<i> +                       QString allowinsert = e1.firstChildElement (
</I>&gt;<i> &quot;ALLOWINSERT&quot; ).toElement().text();
</I>&gt;<i> +                       QString allowdelete = e1.firstChildElement (
</I>&gt;<i> &quot;ALLOWDELETE&quot; ).toElement().text();
</I>&gt;<i> +                       QString setsorting = e1.firstChildElement (
</I>&gt;<i> &quot;SETSORTING&quot; ).toElement().text();
</I>&gt;<i> +                       ///
</I>&gt;<i> +
</I>&gt;<i> +                       subform-&gt;setDbTableName ( tablename );
</I>&gt;<i> +                       subform-&gt;setDbFieldId ( fieldid );
</I>&gt;<i> +                       subform-&gt;setFileConfig ( fileconfig );
</I>&gt;<i> +
</I>&gt;<i> +                       /// Hacemos el tratamiento de los headers
</I>&gt;<i> +                           QDomNodeList nodos = e1.elementsByTagName (
</I>&gt;<i> &quot;HEADER&quot; );
</I>&gt;<i> +                           for ( int j = 0; j &lt; nodos.count(); j++ ) {
</I>&gt;<i> +                               QDomNode ventana = nodos.item ( j );
</I>&gt;<i> +                               QDomElement header = ventana.toElement();
</I>&gt;<i> +
</I>&gt;<i> +                               BlDbField::DbType type =
</I>&gt;<i> BlDbField::DbVarChar;
</I>&gt;<i> +                               QString nomheader =
</I>&gt;<i> header.firstChildElement ( &quot;NOMCAMPO&quot; ).toElement().text();
</I>&gt;<i> +                               QString nompheader =
</I>&gt;<i> header.firstChildElement ( &quot;NOMPCAMPO&quot; ).toElement().text();
</I>&gt;<i> +                               QString typeheader =
</I>&gt;<i> header.firstChildElement ( &quot;DBTYPECAMPO&quot; ).toElement().text();
</I>&gt;<i> +                               if ( typeheader == &quot;DBVARCHAR&quot; ) {
</I>&gt;<i> +                                   type = BlDbField::DbVarChar;
</I>&gt;<i> +                               } else if ( typeheader == &quot;DBINT&quot; ) {
</I>&gt;<i> +                                   type = BlDbField::DbInt;
</I>&gt;<i> +                               } else if ( typeheader == &quot;DBNUMERIC&quot; ) {
</I>&gt;<i> +                                   type = BlDbField::DbNumeric;
</I>&gt;<i> +                               } else if ( typeheader == &quot;DBBOOLEAN&quot; ) {
</I>&gt;<i> +                                   type = BlDbField::DbBoolean;
</I>&gt;<i> +                               } else if ( typeheader == &quot;DBDATE&quot; ) {
</I>&gt;<i> +                                   type = BlDbField::DbDate;
</I>&gt;<i> +                               } // end if
</I>&gt;<i> +
</I>&gt;<i> +                               int restricciones = ( int )
</I>&gt;<i> BlDbField::DbNothing;
</I>&gt;<i> +                               QDomElement restrict =
</I>&gt;<i> header.firstChildElement ( &quot;RESTRICTIONSCAMPO&quot; );
</I>&gt;<i> +                               while ( !restrict.isNull() ) {
</I>&gt;<i> +                                   QString trestrict = restrict.text();
</I>&gt;<i> +                                   if ( trestrict == &quot;DBNOTHING&quot; ) {
</I>&gt;<i> +                                       restricciones |=
</I>&gt;<i> BlDbField::DbNothing;
</I>&gt;<i> +                                   } else if ( trestrict == &quot;DBNOTNULL&quot; )
</I>&gt;<i> {
</I>&gt;<i> +                                       restricciones |=
</I>&gt;<i> BlDbField::DbNotNull;
</I>&gt;<i> +                                   } else if ( trestrict ==
</I>&gt;<i> &quot;DBPRIMARYKEY&quot; ) {
</I>&gt;<i> +                                       restricciones |=
</I>&gt;<i> BlDbField::DbPrimaryKey;
</I>&gt;<i> +                                   } else if ( trestrict == &quot;DBNOSAVE&quot; ) {
</I>&gt;<i> +                                       restricciones |=
</I>&gt;<i> BlDbField::DbNoSave;
</I>&gt;<i> +                                   } else if ( trestrict == &quot;DBAUTO&quot; ) {
</I>&gt;<i> +                                       restricciones |= BlDbField::DbAuto;
</I>&gt;<i> +                                   } else if ( trestrict ==
</I>&gt;<i> &quot;DBDUPPRIMARYKEY&quot; ) {
</I>&gt;<i> +                                       restricciones |=
</I>&gt;<i> BlDbField::DbDupPrimaryKey;
</I>&gt;<i> +                                   } else if ( trestrict == &quot;DBREQUIRED&quot;
</I>&gt;<i> ) {
</I>&gt;<i> +                                       restricciones |=
</I>&gt;<i> BlDbField::DbRequired;
</I>&gt;<i> +                                   } else if ( trestrict == &quot;DBNOLOAD&quot; ) {
</I>&gt;<i> +                                       restricciones |=
</I>&gt;<i> BlDbField::DbNoLoad;
</I>&gt;<i> +                                   } // end if
</I>&gt;<i> +                                   restrict = restrict.nextSiblingElement
</I>&gt;<i> ( &quot;RESTRICTIONSCAMPO&quot; );
</I>&gt;<i> +                               } // end while
</I>&gt;<i> +                               int opciones = ( int )
</I>&gt;<i> BlSubFormHeader::DbNone;
</I>&gt;<i> +                               QDomElement opci =
</I>&gt;<i> header.firstChildElement ( &quot;OPTIONSHEADER&quot; );
</I>&gt;<i> +                               while ( !opci.isNull() ) {
</I>&gt;<i> +                                   QString topci = opci.text();
</I>&gt;<i> +                                   if ( topci == &quot;DBNONE&quot; ) {
</I>&gt;<i> +                                       opciones |=
</I>&gt;<i> BlSubFormHeader::DbNone;
</I>&gt;<i> +                                   } else if ( topci == &quot;DBREADONLY&quot; ) {
</I>&gt;<i> +                                       opciones |=
</I>&gt;<i> BlSubFormHeader::DbReadOnly;
</I>&gt;<i> +                                   } else if ( topci == &quot;DBHIDEVIEW&quot; ) {
</I>&gt;<i> +                                       opciones |=
</I>&gt;<i> BlSubFormHeader::DbHideView;
</I>&gt;<i> +                                   } else if ( topci == &quot;DBNOWRITE&quot; ) {
</I>&gt;<i> +                                       opciones |=
</I>&gt;<i> BlSubFormHeader::DbNoWrite;
</I>&gt;<i> +                                   } else if ( topci == &quot;DBDISABLEVIEW&quot; )
</I>&gt;<i> {
</I>&gt;<i> +                                       opciones |=
</I>&gt;<i> BlSubFormHeader::DbDisableView;
</I>&gt;<i> +                                   } // end if
</I>&gt;<i> +                                   opci = opci.nextSiblingElement (
</I>&gt;<i> &quot;OPTIONSHEADER&quot; );
</I>&gt;<i> +                               } // end while
</I>&gt;<i> +                               subform-&gt;addSubFormHeader ( nomheader,
</I>&gt;<i> type, ( BlDbField::DbRestrict ) restricciones, opciones , nompheader );
</I>&gt;<i> +                           } // end for
</I>&gt;<i> +                       subform-&gt;setInsert ( allowinsert == &quot;TRUE&quot; );
</I>&gt;<i> +                       subform-&gt;setDelete ( allowdelete == &quot;TRUE&quot; );
</I>&gt;<i> +                       subform-&gt;setSortingEnabled ( setsorting == &quot;TRUE&quot;
</I>&gt;<i> );
</I>&gt;<i> +                       subform-&gt;inicializar();
</I>&gt;<i> +
</I>&gt;<i> +                   } // end if
</I>&gt;<i> +               } // end for
</I>&gt;<i> +       } // end if
</I>&gt;<i> +    } // end for
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i>      QDomElement principal = docElem.firstChildElement ( &quot;FICHA&quot; );
</I>&gt;<i>      /// Cogemos la coordenada X
</I>&gt;<i>      QString tablename = principal.firstChildElement ( &quot;TABLENAME&quot;
</I>&gt;<i> ).toElement().text();
</I>&gt;<i> @@ -538,14 +759,12 @@ void BlForm::insertWindow ( QString nom, QObject
</I>&gt;<i> *obj, bool compdup, QString tit
</I>&gt;<i>      BL_FUNC_DEBUG
</I>&gt;<i>      if ( mainCompany() != NULL ) {
</I>&gt;<i>          mainCompany() -&gt;insertWindow ( nom, obj, compdup, titulo );
</I>&gt;<i> -    } // end if
</I>&gt;<i> -
</I>&gt;<i> -    /// De Forma rapida hacemos un tratamiento de los permisos
</I>&gt;<i> -    setDbTableName ( tableName() );
</I>&gt;<i> -    /// Tal vez no es el mejor sitio para hacer la carga de SPECS. Pero
</I>&gt;<i> no hay llamada especifica
</I>&gt;<i> -    /// De configuracion por lo que si no es este no es ninguno.
</I>&gt;<i> -    loadSpecs();
</I>&gt;<i> -
</I>&gt;<i> +       /// De Forma rapida hacemos un tratamiento de los permisos
</I>&gt;<i> +       setDbTableName ( tableName() );
</I>&gt;<i> +       /// Tal vez no es el mejor sitio para hacer la carga de SPECS.
</I>&gt;<i> Pero no hay llamada especifica
</I>&gt;<i> +       /// De configuracion por lo que si no es este no es ninguno.
</I>&gt;<i> +       loadSpecs();
</I>&gt;<i> +    } // end if
</I>&gt;<i>  }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> @@ -899,6 +1118,56 @@ int BlForm::load ( QString id, bool paint )
</I>&gt;<i>          /// Activamos documentos adicionales
</I>&gt;<i>          activateDocuments();
</I>&gt;<i>
</I>&gt;<i> +
</I>&gt;<i> +       /// Cargamos los subformularios de specificaciones
</I>&gt;<i> +    /// Cargamos el XML de descripcion de autoforms y lo procesamos.
</I>&gt;<i> +    QFile file ( CONFIG_DIR_CONFIG + objectName() + &quot;_&quot; + mainCompany()
</I>&gt;<i> -&gt;dbName() + &quot;_spec.spc&quot;);
</I>&gt;<i> +    QDomDocument doc ( &quot;mydocument&quot; );
</I>&gt;<i> +    if ( !file.open ( QIODevice::ReadOnly ) ) {
</I>&gt;<i> +        return 0;
</I>&gt;<i> +    } // end if
</I>&gt;<i> +    if ( !doc.setContent ( &amp;file ) ) {
</I>&gt;<i> +        file.close();
</I>&gt;<i> +       blMsgInfo(&quot;Error al parsear el archivo de especificaciones&quot;);
</I>&gt;<i> +        return 0;
</I>&gt;<i> +    } // end if
</I>&gt;<i> +    file.close();
</I>&gt;<i> +
</I>&gt;<i> +    /// Iteramos para cada AutoForm y lo creamos haciendo todo lo
</I>&gt;<i> necesario para que este funcione.
</I>&gt;<i> +    QDomElement docElem = doc.documentElement();
</I>&gt;<i> +
</I>&gt;<i> +    QDomNodeList nodos = docElem.elementsByTagName ( &quot;TAB&quot; );
</I>&gt;<i> +    for ( int i = 0; i &lt; nodos.count(); i++ ) {
</I>&gt;<i> +        QDomNode autoform = nodos.item ( i );
</I>&gt;<i> +        QDomElement e1 = autoform.toElement(); /// try to convert the
</I>&gt;<i> node to an element.
</I>&gt;<i> +        if ( !e1.isNull() ) { /// the node was really an element.
</I>&gt;<i> +
</I>&gt;<i> +               /// Cargamos los subformularios
</I>&gt;<i> +               QDomNodeList nodoss = e1.elementsByTagName ( &quot;SUBFORM&quot; );
</I>&gt;<i> +               for ( int j = 0; j &lt; nodoss.count(); j++ ) {
</I>&gt;<i> +                   QDomNode ventana = nodoss.item ( j );
</I>&gt;<i> +                   QDomElement e1 = ventana.toElement(); /// try to
</I>&gt;<i> convert the node to an element.
</I>&gt;<i> +                   if ( !e1.isNull() ) { /// the node was really an
</I>&gt;<i> element.
</I>&gt;<i> +                       BlDbField::DbType type = BlDbField::DbVarChar;
</I>&gt;<i> +                       QString nomheader = e1.firstChildElement (
</I>&gt;<i> &quot;NOMCAMPO&quot; ).toElement().text();
</I>&gt;<i> +                       BlSubForm * subform = findChild&lt;BlSubForm
</I>&gt;<i> *&gt;(&quot;mui_&quot; + nomheader);
</I>&gt;<i> +                       if (subform) {
</I>&gt;<i> +                          /// Ya tenemos el subformulario presente. Y
</I>&gt;<i> ahora podemos hacer lo que nos plazca.
</I>&gt;<i> +                          QString query = e1.firstChildElement ( &quot;QUERY&quot;
</I>&gt;<i> ).toElement().text();
</I>&gt;<i> +                          /// Sustituimos las variables encontradas.
</I>&gt;<i> +                          substrVars(query,0);
</I>&gt;<i> +                          subform-&gt;load(query);
</I>&gt;<i> +                       } // end if
</I>&gt;<i> +                   } // end if
</I>&gt;<i> +               } // end for
</I>&gt;<i> +       } // end if
</I>&gt;<i> +    } // end for
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i>          if ( paint == TRUE ) {
</I>&gt;<i>              pintar();
</I>&gt;<i>          } // end if
</I>&gt;<i> @@ -1046,6 +1315,64 @@ int BlForm::afterSave()
</I>&gt;<i>  {
</I>&gt;<i>      BL_FUNC_DEBUG
</I>&gt;<i>
</I>&gt;<i> +
</I>&gt;<i> +    /// Guardamos datos de los subformularios de especificaciones
</I>&gt;<i> +
</I>&gt;<i> +    /// Cargamos el XML de descripcion de autoforms y lo procesamos.
</I>&gt;<i> +    QFile file (  CONFIG_DIR_CONFIG + objectName() + &quot;_&quot; + mainCompany()
</I>&gt;<i> -&gt;dbName() + &quot;_spec.spc&quot; );
</I>&gt;<i> +    QDomDocument doc ( &quot;mydocument&quot; );
</I>&gt;<i> +    if ( !file.open ( QIODevice::ReadOnly ) ) {
</I>&gt;<i> +        return 0;
</I>&gt;<i> +    } // end if
</I>&gt;<i> +    if ( !doc.setContent ( &amp;file ) ) {
</I>&gt;<i> +        file.close();
</I>&gt;<i> +       blMsgInfo(&quot;Error al parsear el archivo de autoformularios&quot;);
</I>&gt;<i> +        return 0;
</I>&gt;<i> +    } // end if
</I>&gt;<i> +    file.close();
</I>&gt;<i> +
</I>&gt;<i> +    /// Iteramos para cada AutoForm y lo creamos haciendo todo lo
</I>&gt;<i> necesario para que este funcione.
</I>&gt;<i> +    QDomElement docElem = doc.documentElement();
</I>&gt;<i> +
</I>&gt;<i> +    QDomNodeList nodos = docElem.elementsByTagName ( &quot;AUTOFORM&quot; );
</I>&gt;<i> +    for ( int i = 0; i &lt; nodos.count(); i++ ) {
</I>&gt;<i> +        QDomNode autoform = nodos.item ( i );
</I>&gt;<i> +        QDomElement e1 = autoform.toElement(); /// try to convert the
</I>&gt;<i> node to an element.
</I>&gt;<i> +        if ( !e1.isNull() ) { /// the node was really an element.
</I>&gt;<i> +
</I>&gt;<i> +               /// Cargamos los subformularios
</I>&gt;<i> +               QDomNodeList nodoss = e1.elementsByTagName ( &quot;SUBFORM&quot; );
</I>&gt;<i> +               for ( int j = 0; j &lt; nodoss.count(); j++ ) {
</I>&gt;<i> +                   QDomNode ventana = nodoss.item ( j );
</I>&gt;<i> +                   QDomElement e1 = ventana.toElement(); /// try to
</I>&gt;<i> convert the node to an element.
</I>&gt;<i> +                   if ( !e1.isNull() ) { /// the node was really an
</I>&gt;<i> element.
</I>&gt;<i> +                       BlDbField::DbType type = BlDbField::DbVarChar;
</I>&gt;<i> +                       QString nomheader = e1.firstChildElement (
</I>&gt;<i> &quot;NOMCAMPO&quot; ).toElement().text();
</I>&gt;<i> +                       BlSubForm * subform = findChild&lt;BlSubForm
</I>&gt;<i> *&gt;(&quot;mui_&quot; + nomheader);
</I>&gt;<i> +                       if (subform) {
</I>&gt;<i> +                          /// Ya tenemos el subformulario presente. Y
</I>&gt;<i> ahora podemos hacer lo que nos plazca.
</I>&gt;<i> +                          QString vinculos = e1.firstChildElement (
</I>&gt;<i> &quot;VINCULOS&quot; ).toElement().text();
</I>&gt;<i> +                          /// Sustituimos las variables que informa el
</I>&gt;<i> campo
</I>&gt;<i> +                           QStringList listavinculos =
</I>&gt;<i> vinculos.split(&quot;,&quot;);
</I>&gt;<i> +                           for (int j1 = 0; j1 &lt; listavinculos.size();
</I>&gt;<i> ++j1) {
</I>&gt;<i> +
</I>&gt;<i> +                                 int posicion = listavinculos.at
</I>&gt;<i> (j1).indexOf(&quot;=&quot;);
</I>&gt;<i> +                                 QString campo = listavinculos.at
</I>&gt;<i> (j1).left(posicion);
</I>&gt;<i> +                                 QString valor = listavinculos.at
</I>&gt;<i> (j1).right(listavinculos.at(j1).size() - posicion -1);
</I>&gt;<i> +
</I>&gt;<i> +                                 subform-&gt;setColumnValue ( campo, dbValue
</I>&gt;<i> ( valor ) );
</I>&gt;<i> +                           } // end for
</I>&gt;<i> +
</I>&gt;<i> +                           subform-&gt;save();
</I>&gt;<i> +                       } // end if
</I>&gt;<i> +                   } // end if
</I>&gt;<i> +               } // end for
</I>&gt;<i> +
</I>&gt;<i> +       } // end if
</I>&gt;<i> +    } // end for
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i>      return 0;
</I>&gt;<i>  }
</I>&gt;<i>
</I>&gt;<i> diff --git a/bulmages/bulmalib/src/blform.h
</I>&gt;<i> b/bulmages/bulmalib/src/blform.h
</I>&gt;<i> index 7bb6971..0a5dfa4 100644
</I>&gt;<i> --- a/bulmages/bulmalib/src/blform.h
</I>&gt;<i> +++ b/bulmages/bulmalib/src/blform.h
</I>&gt;<i> @@ -46,6 +46,8 @@ private:
</I>&gt;<i>      edmode m_modo;
</I>&gt;<i>      QString m_title;
</I>&gt;<i>      QScriptEngine m_myEngine;
</I>&gt;<i> +    bool m_firstLoad;
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i>  protected:
</I>&gt;<i>      void setSelectMode();
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://gitorious.org/bulmages">https://gitorious.org/bulmages</A>
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> You are receiving this email because you have chosen to be notified by
</I>&gt;<i> email whenever this favorite has new activity. You can manage your
</I>&gt;<i> favorite subscriptions at <A HREF="https://gitorious.org/favorites">https://gitorious.org/favorites</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Bulmages-main mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/bulmages-main">Bulmages-main at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/bulmages-main">https://lists.berlios.de/mailman/listinfo/bulmages-main</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/bulmages-main/attachments/20130208/548e2d06/attachment-0001.html">https://lists.berlios.de/pipermail/bulmages-main/attachments/20130208/548e2d06/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Mensaje anterior: <A HREF="007522.html">[BulmaGés] [Gitorious] Activity: tborras pushed 1	commits to master...
</A></li>
	<LI>Próximo mensaje: <A HREF="007524.html">[BulmaGés][Gitorious] Activity: tborras pushed 1 commits to master...
</A></li>
         <LI> <B>Mensajes ordenados por:</B> 
              <a href="date.html#7523">[ fecha ]</a>
              <a href="thread.html#7523">[ hilo ]</a>
              <a href="subject.html#7523">[ asunto ]</a>
              <a href="author.html#7523">[ autor ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/bulmages-main">Más información sobre la lista de distribución Bulmages-main </a><br>
</body></html>
