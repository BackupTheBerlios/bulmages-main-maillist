<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [BulmaGés]r2884 - in trunk/bulmages/bulmafact: plugins plugins/pluginalbaran plugins/pluginalbaranprov plugins/pluginbarcodeopen plugins/plugincobros plugins/plugincompraventa plugins/pluginetiquetado plugins/pluginetiquetas plugins/pluginfactura plugins/pluginfacturaprov plugins/pluginfacturar plugins/pluginimpresionesmultiples plugins/pluginmail plugins/pluginmailthunderbird plugins/pluginpedido plugins/pluginpedidoprov plugins/pluginpresupuesto plugins/pluginq19 plugins/pluginticket plugins/plugintrazabilidad src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/bulmages-main/2009-January/index.html" >
   <LINK REL="made" HREF="mailto:bulmages-main%40lists.berlios.de?Subject=Re%3A%20%3D%3Futf-8%3Fb%3FW0J1bG1hR8Opc10%3D%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fr2884_-_in_trunk/bulm%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fages/bulmafact%3D3A_plugins_plugins/pluginalbaran_plugins/pl%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fuginalbaranprov_plugins/pluginbarcodeopen_plugins/pluginco%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fbros_plugins/plugincompraventa_plugins/pluginetiquetado_pl%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fugins/pluginetiquetas_plugins/pluginfactura_plugins/plugin%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Ffacturaprov_plugins/pluginfacturar_plugins/pluginimpresion%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fesmultiples_plugins/pluginmail_plugins/pluginmailthunderbi%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Frd_plugins/pluginpedido_plugins/pluginpedidoprov_plugins/p%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fluginpresupuesto_plugins/pluginq19_plugins/pluginticket_pl%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fugins/plugintrazabilidad_src%3F%3D&In-Reply-To=%3C200901072112.13259.tborras%40conetxia.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <LINK REL="Previous"  HREF="000745.html">
   <LINK REL="Next"  HREF="000748.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[BulmaGés]r2884 - in trunk/bulmages/bulmafact: plugins plugins/pluginalbaran plugins/pluginalbaranprov plugins/pluginbarcodeopen plugins/plugincobros plugins/plugincompraventa plugins/pluginetiquetado plugins/pluginetiquetas plugins/pluginfactura plugins/pluginfacturaprov plugins/pluginfacturar plugins/pluginimpresionesmultiples plugins/pluginmail plugins/pluginmailthunderbird plugins/pluginpedido plugins/pluginpedidoprov plugins/pluginpresupuesto plugins/pluginq19 plugins/pluginticket plugins/plugintrazabilidad src </H1>
    <B>Tomeu Borras</B> 
    <A HREF="mailto:bulmages-main%40lists.berlios.de?Subject=Re%3A%20%3D%3Futf-8%3Fb%3FW0J1bG1hR8Opc10%3D%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fr2884_-_in_trunk/bulm%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fages/bulmafact%3D3A_plugins_plugins/pluginalbaran_plugins/pl%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fuginalbaranprov_plugins/pluginbarcodeopen_plugins/pluginco%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fbros_plugins/plugincompraventa_plugins/pluginetiquetado_pl%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fugins/pluginetiquetas_plugins/pluginfactura_plugins/plugin%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Ffacturaprov_plugins/pluginfacturar_plugins/pluginimpresion%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fesmultiples_plugins/pluginmail_plugins/pluginmailthunderbi%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Frd_plugins/pluginpedido_plugins/pluginpedidoprov_plugins/p%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fluginpresupuesto_plugins/pluginq19_plugins/pluginticket_pl%3F%3D%0A%20%3D%3Fiso-8859-1%3Fq%3Fugins/plugintrazabilidad_src%3F%3D&In-Reply-To=%3C200901072112.13259.tborras%40conetxia.com%3E"
       TITLE="[BulmaGés]r2884 - in trunk/bulmages/bulmafact: plugins plugins/pluginalbaran plugins/pluginalbaranprov plugins/pluginbarcodeopen plugins/plugincobros plugins/plugincompraventa plugins/pluginetiquetado plugins/pluginetiquetas plugins/pluginfactura plugins/pluginfacturaprov plugins/pluginfacturar plugins/pluginimpresionesmultiples plugins/pluginmail plugins/pluginmailthunderbird plugins/pluginpedido plugins/pluginpedidoprov plugins/pluginpresupuesto plugins/pluginq19 plugins/pluginticket plugins/plugintrazabilidad src">tborras en conetxia.com
       </A><BR>
    <I>Mie Ene  7 21:12:13 CET 2009</I>
    <P><UL>
        <LI>Mensaje anterior: <A HREF="000745.html">[BulmaGés]r2884 - in trunk/bulmages/bulmafact: plugins plugins/pluginalbaran plugins/pluginalbaranprov plugins/pluginbarcodeopen plugins/plugincobros plugins/plugincompraventa plugins/pluginetiquetado plugins/pluginetiquetas plugins/pluginfactura plugins/pluginfacturaprov plugins/pluginfacturar plugins/pluginimpresionesmultiples plugins/pluginmail plugins/pluginmailthunderbird plugins/pluginpedido plugins/pluginpedidoprov plugins/pluginpresupuesto plugins/pluginq19 plugins/pluginticket plugins/plugintrazabilidad	src
</A></li>
        <LI>Próximo mensaje: <A HREF="000748.html">[BulmaGés] r2885 -	trunk/bulmages/images/oxygen/actions
</A></li>
         <LI> <B>Mensajes ordenados por:</B> 
              <a href="date.html#747">[ fecha ]</a>
              <a href="thread.html#747">[ hilo ]</a>
              <a href="subject.html#747">[ asunto ]</a>
              <a href="author.html#747">[ autor ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> Això vol dir que no pot funcionar pluginPresupuesto sense plugin Factura ?
</I>&gt;<i> Suposo que no és això. Suposo que l'ús real de factura està condicionat a
</I>&gt;<i> que estigui instal·lat.
</I>&gt;<i>
</I>Exacte !!!. L'us només esta condicionat a que estigui instalat malgrat que 
tingui dependencies en la compilació.


&gt;<i> Però llavors pot funcionar pluginPresupuesto amb un plugin de Factura
</I>&gt;<i> diferent ?
</I>
Si. Aqui ho detallo una mica més perque ho vegis clar.

La dependencia que te factura amb presupost es única i exclusivament en el 
tema de pasar de presupost a factura. I això es un botó dintre de la finestra 
del presupost que activa un SLOT de Qt. (Fins aqui bé).

Ara amb el canvi que hem fet consisteix principalment en que qui posa i 
controla el botó no es la clase presupost sino la clase genfacqtoolbutton 
(que esta implementada dins el plugin de factura, a efectes pràctics pots 
considerar que es la clase factura).
Es a dir que quan es crea una instancia de presupost se dispara la cridada a 
plugins PresupuestoView_PresupuestoView(PresupuestoView *) i el plugin de 
factura (si esta instalat) captura aquesta cridada i introdueix el botó de 
pasar a factura dintre la finestra de presupost i enllaça cap al seu propi 
codi. Per tant si el plugin de factura no estigues instalat la cridada a 
plugin PresupuestoView_PresupuestoView(PresupuestoView *) no sería contestada 
per ningú i en conseqüencia no tindriem botó a dins la finestra de presupost.

I si cream un altre plugin de factues alternatiu el que ha de fer es 
implementar el seu propi botó de pasar a factura i així podrem emprar  un 
plugin o l'altre sense haver de reimplementar la clase presupost.

&gt;<i>
</I>&gt;<i> Com es defineix la interfície entre els dos ?
</I>&gt;<i>
</I>No es difícil:
Totes les clases derivades de Ficha tenen una serie de frames comuns
mui_plugbotones, mui_tab i un altre que ara no recordo.
Aquests frames son els que empleen els plugins per expandirse 
	- Si el que es vol es afegir un nou botó de acció has de crear el botó i 
introduir-lo dins mui_plugbotones perque aparegui a la fitxa.
	- Si el que vols es expandir dades normalment recorrem a crear una nova 
pestanya al mui_tab i enganxar de aquesta tot el que volem que el plugin 
presenti. (A les fitxes de client, proveidor i article se veu molt clar com 
van creixent els tabs depenguent de quins plugins tenguis instalats)

En casos molt especials igual has de anar per la jerarquia de objectes de Qt. 
Pero encara no he trobat un cas on faci falta.


&gt;<i> és factura.h aquesta interfície ?
</I>
La interficie es combinada. Presupost te una interficie base disenyada amb el 
designer-qt4. Però el botó que se afegeix si tens el plugin de factura 
instalat es un botó definit a genfacqtoolbutton i que se afegeix dintre del 
mui_plugbotones del presupost.
En el cas dels tabs el que fas es fer un diseny apart del que anirà dintre de 
la pestanya i enfonyes aquest disseny a la fitxa que correspon (hi ha un 
exemple a pluginpromedios, pluginalias també ho fa enfonyant un subform3 com 
a tab nou).

També hi ha altres plugins que modifiquen altres llocs de interficie com els 
que fan QToolBars noves i cosetes de aquestes pero son casos on no hi ha 
integració entre interficies sino mes aviat el afegir una opció nova i crear 
una instancia de un QtoolBar que va  per lliure.

&gt;<i>
</I>&gt;<i> &gt; El problema es, casi siempre salvable, estableciendo ordenes de
</I>&gt;<i> &gt; compilacion y dependencias entre plugins. Pero, como no, podemos tener
</I>&gt;<i> &gt; dependencias cíclicas que nos fastidian todo el tinglado.
</I>&gt;<i>
</I>&gt;<i> Vols dir dependències de compilació, oi ? No necesariament coincideixen
</I>&gt;<i> amb dependències d'instal·lació ? o si ?
</I>&gt;<i>
</I>Exacte, només de compilació.


&gt;<i> &gt; Por esto me he visto obligado a hacer una guarrada en los CMakeList para
</I>&gt;<i> &gt; que en algun caso concreto el uic genere tambien las pantallas de otro
</I>&gt;<i> &gt; plugin. Aunque la mejor forma de solucionarlo es conseguir que cmake haga
</I>&gt;<i> &gt; uic en todos los subproyectos para luego compilar.
</I>&gt;<i>
</I>&gt;<i> Suposo que sí, però què passa si un dia tens dos plugins de factures
</I>&gt;<i> diferents, quina pantalla usarà el plugin que usi factures ? Hi ha una
</I>&gt;<i> interfície comuna que és el que s'inclou ? O quan canviïs la pantalla del
</I>&gt;<i> plugin de factures hauràs de canviar coses als plugins que la facin servir
</I>&gt;<i> ?. Jo no acabo d'entendre com va tot això .
</I>&gt;<i>
</I>Si fas dos plugins de factures es perque necessites dues interficies diferents 
i cada un emplearà la seva propia. Sino el que faries es un plugin que 
modifiques el plugin de factures original.

Si hi hagues un plugin que hagués de modificar ambdos plugins al mateix temps 
aleshores el que s'ahuria de fer es que tots dos plugins disparasin la 
mateixa cridada a plugins (un cas semblant es la cridada entryPoint que tenen 
Bulmafact i Bulmacont i com responen a ella els plugins de bulmalib que son 
comuns a ambdos programes). També depenent del cas podries fer un plugin que 
se encastres dintre de les clases se nivell superior i fes distinció 
mitjançant l'objectName. Això està implementat al pluginimpresionesmultiples 
i al pluginmail i també al plugincuenta (de bulmacont).


&gt;<i> &gt; Casting Obligatorio en los Plugins + variable global
</I>&gt;<i> &gt; ==============================
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Este es el tema que mencioné en un correo anterior que nos obligaba a
</I>&gt;<i> &gt; tener una variable global adicional en plugins.h para poder recuperar
</I>&gt;<i> &gt; punteros (void *) y reformarlos con un casting a la clase que nos
</I>&gt;<i> &gt; interesa. Me preocupa porque asi como esta ahora podría ser un foco de
</I>&gt;<i> &gt; errores con multiples Threads.
</I>&gt;<i>
</I>&gt;<i> Ni idea. Allò de la funció factory no ajuda ?
</I>
La veritat es que no li he dedicat gaire temps a això. Necessitava que 
funciones i vaig tirar per la via ràpida.

&gt;<i>
</I>&gt;<i> &gt; No estan arreglados los menus de primer nivel
</I>&gt;<i> &gt; ============================
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Si no cargamos ningún plugin de compras o de ventas nos quedaran en el
</I>&gt;<i> &gt; programa los menus de primer nivel &quot;Compras&quot; o &quot;Ventas&quot; que estarán
</I>&gt;<i> &gt; vacios (Sin opciones seleccionabgles). No es un problema de
</I>&gt;<i> &gt; funcionamiento pero si es nefasto a nivel visual.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; La solución al problema  pasa por quitar dichas opciones de menu y que
</I>&gt;<i> &gt; cada uno de los plugins que se adieren al menu comprueben la existencia
</I>&gt;<i> &gt; de dicho menu y si estuviese creado colgarse del creado y si no estuviese
</I>&gt;<i> &gt; creado crear el menu y colgarse de este.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Esto ya se hace en plugininformes y en plugininformesODS con las opciones
</I>&gt;<i> &gt; de informes.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Sin embargo hay un problema que aun no he logrado arreglar y es que al
</I>&gt;<i> &gt; crear el menu lo queremos poser en una posición determinada y no al
</I>&gt;<i> &gt; final. Si se tratase de intercalar un solo menu esta chupado saber en que
</I>&gt;<i> &gt; posicion debe ir. Pero al tratarse de intercalar multiples menus adivinar
</I>&gt;<i> &gt; la posición que le corresponde es muy difícil ya que dependiendo del
</I>&gt;<i> &gt; orden en que esten colocados los plugins en el archivo de configuracion
</I>&gt;<i> &gt; las posiciones tambien variarán.
</I>&gt;<i>
</I>&gt;<i> Si ho entenc bé sembla que la solució seria tenir una llista de menús que
</I>&gt;<i> inclogués tots els possibles en l'ordre en que sortirien per a una empresa
</I>&gt;<i> que tingués tots els pugins activats. Llavors cada plugin, abans d'insertar
</I>&gt;<i> el seu menú si no existeix mira on aniria a la llista completa, i va tirant
</I>&gt;<i> cap a l'esquerra fins que troba un menú que sí que existeix a la
</I>&gt;<i> configuració actual. Llavors inserta el seu menú després del que existeix.
</I>
Jo el que faria es partir dels menus que segur son a la 
aplicació.&quot;Archivo&quot;, &quot;Ver&quot;, &quot;Maestro&quot; i &quot;Ayuda&quot;. Llavors només permetria 
insercions de menus de primer nivell despres de Archivo, després de Ver i 
després de Maestro o abans de Ver, abans de maestro i abans de ajuda.

L'ordre final en que quedaría el menu de la aplicació dependria de l'ordre en 
que estan colocats els plugins dins el arxiu de configuració, pero malgrat 
això tendriem la certessa de que Archivo va al principi i Ayuda va al final.

Salut
-- 
Tomeu Borrás Riera
Conetxia Soluciones Informáticas
902 88 11 66
971 29 06 29

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Mensaje anterior: <A HREF="000745.html">[BulmaGés]r2884 - in trunk/bulmages/bulmafact: plugins plugins/pluginalbaran plugins/pluginalbaranprov plugins/pluginbarcodeopen plugins/plugincobros plugins/plugincompraventa plugins/pluginetiquetado plugins/pluginetiquetas plugins/pluginfactura plugins/pluginfacturaprov plugins/pluginfacturar plugins/pluginimpresionesmultiples plugins/pluginmail plugins/pluginmailthunderbird plugins/pluginpedido plugins/pluginpedidoprov plugins/pluginpresupuesto plugins/pluginq19 plugins/pluginticket plugins/plugintrazabilidad	src
</A></li>
	<LI>Próximo mensaje: <A HREF="000748.html">[BulmaGés] r2885 -	trunk/bulmages/images/oxygen/actions
</A></li>
         <LI> <B>Mensajes ordenados por:</B> 
              <a href="date.html#747">[ fecha ]</a>
              <a href="thread.html#747">[ hilo ]</a>
              <a href="subject.html#747">[ asunto ]</a>
              <a href="author.html#747">[ autor ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/bulmages-main">Más información sobre la lista de distribución Bulmages-main </a><br>
</body></html>
